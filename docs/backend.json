
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile information.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the UserProfile entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "firstName": {
          "type": "string",
          "description": "User's first name."
        },
        "lastName": {
          "type": "string",
          "description": "User's last name."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp of when the user profile was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp of when the user profile was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email",
        "firstName",
        "lastName",
        "createdAt",
        "updatedAt"
      ]
    },
    "Hospital": {
      "title": "Hospital",
      "type": "object",
      "description": "Represents a hospital's information.",
      "properties": {
        "name": {
          "type": "string"
        },
        "location": {
          "type": "string"
        },
        "rating": {
          "type": "number"
        },
        "price": {
          "type": "number"
        },
        "specialty": {
          "type": "string"
        },
        "emergency": {
          "type": "boolean"
        },
        "imageUrl": {
          "type": "string"
        },
        "imageHint": {
          "type": "string"
        },
        "pros": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "cons": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "Doctor": {
      "title": "Doctor",
      "type": "object",
      "description": "Represents a doctor's information.",
      "properties": {
        "name": {
          "type": "string"
        },
        "specialty": {
          "type": "string"
        },
        "hospital": {
          "type": "string"
        },
        "rating": {
          "type": "number"
        },
        "experience": {
          "type": "number"
        },
        "boardCertified": {
          "type": "boolean"
        },
        "imageUrl": {
          "type": "string"
        },
        "imageHint": {
          "type": "string"
        },
        "pros": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "cons": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information. Secured via path-based ownership; only the authenticated user (userId) can read/write their profile. Includes standard user profile fields such as email, first name, last name, and timestamps. This enables straightforward security rules based on `request.auth.uid == userId`.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/hospitals/{hospitalId}",
        "definition": {
          "entityName": "Hospital",
          "schema": {
            "$ref": "#/backend/entities/Hospital"
          },
          "description": "Publicly accessible list of all hospitals.",
          "params": [
            {
              "name": "hospitalId",
              "description": "The unique identifier of the hospital."
            }
          ]
        }
      },
      {
        "path": "/doctors/{doctorId}",
        "definition": {
          "entityName": "Doctor",
          "schema": {
            "$ref": "#/backend/entities/Doctor"
          },
          "description": "Publicly accessible list of all doctors.",
          "params": [
            {
              "name": "doctorId",
              "description": "The unique identifier of the doctor."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support user authentication and profile management while adhering to the principles of Authorization Independence, Clarity of Intent, DBAC (Database-Based Access Control), and QAPs (Rules are not Filters). The structure prioritizes path-based ownership for user profiles, ensuring secure and scalable data access. By placing user profiles directly under `/users/{userId}`, we leverage Firebase's security rules to easily control access based on the authenticated user's ID. This design avoids the need for complex authorization logic or hierarchical dependencies, promoting atomic operations and simplified debugging. The structure segregates user profile data into a dedicated collection, which simplifies security rules by ensuring all documents within the collection share the same security requirements. This eliminates the risk of mixing data with different access needs and further enhances security."
  }
}
